package mainClass;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

import classes.NetworkComponent;
import classes.Vulnerability;

public class ConfigureDatabase {

	public static void loadVulnerabilities() {
		String fileName = "/Users/yatinwadhawan/Documents/Projects/DatabaseToGraph/src/database/Vulnerability";
		String line = null;

		try {
			FileReader fileReader = new FileReader(fileName);
			BufferedReader bufferedReader = new BufferedReader(fileReader);
			while ((line = bufferedReader.readLine()) != null) {
				if (line.length() != 0) {
					Vulnerability v = new Vulnerability();
					v.setName(line.toUpperCase());
					line = bufferedReader.readLine();
					v.setProbability(Double.parseDouble(line));
					v.setCvssScore(v.getProbability() * 10);
					line = bufferedReader.readLine();
					v.setDetails(line);

					MainClass.vulnerabilityList.add(v);
					MainClass.vulnerabilityMap.put(v.getName(), v);
				}
			}

			bufferedReader.close();
		} catch (FileNotFoundException ex) {
			System.out.println("Unable to open file '" + fileName + "'");
		} catch (IOException ex) {
			System.out.println("Error reading file '" + fileName + "'");
		}
	}

	public static void loadNetworkComponent() {
		String fileName = "/Users/yatinwadhawan/Documents/android/BN/src/com/src/database/NetworkComponent";
		String line = null;

		try {
			FileReader fileReader = new FileReader(fileName);
			BufferedReader bufferedReader = new BufferedReader(fileReader);
			while ((line = bufferedReader.readLine()) != null) {
				if (line.length() != 0) {
					NetworkComponent nc = new NetworkComponent();
					nc.setName(line.toUpperCase());
					line = bufferedReader.readLine();
					nc.setDetails(line);

					MainClass.networkMap.put(nc.getName().toUpperCase(), nc);
				}
			}

			bufferedReader.close();
		} catch (FileNotFoundException ex) {
			System.out.println("Unable to open file '" + fileName + "'");
		} catch (IOException ex) {
			System.out.println("Error reading file '" + fileName + "'");
		}
	}

}
